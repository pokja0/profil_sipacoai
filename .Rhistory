return new Intl.NumberFormat('id-ID').format(value);
}"
)
)
) |>
# (Opsional) Terapkan juga pada sumbu Y agar konsisten
e_y_axis(
formatter = e_axis_formatter(
style = "decimal",
locale = "id-ID"
)
) |>
e_title("Grafik dengan Label Bar (Data Labels) dan Pemisah Ribuan")
runApp()
shiny::runApp()
100 * 0.95
round(0.6)
ceiling(0.6)
floor(0.6)
floor(1.1)
floor(1.9)
round(1.9)
runApp()
## batas gu judul
data_bkb_keluarga <- fread("data/data_bkb_keluarga.csv")
View(data_bkb_keluarga)
filter_kabupaten = c["PASANGKAYU", "PASANGKAYU", "MAMUJU", "MAMUJU"]
filter_kabupaten = c("PASANGKAYU", "PASANGKAYU", "MAMUJU", "MAMUJU")
filter_kecamatan = c("PASANGKAYU", "PASANGKAYU", "PAPALANG", "PAPALANG")
filter_desa = c("AKO", "GUNUNG SARI", "BODA-BODA", "SISANGO")
filter_bulan = c('SEPTEMBER')
data_bkr <- fread("data/data_bkr.csv", sep = ";")
data_bkl <- fread("data/data_bkl.csv", sep = ";")
data_pus <- fread("data/data_pus.csv", sep = ";", header = T)
# Baca data sasaran poktan
sasaran_poktan <- fread("data/sasaran_poktan_gabung.csv", sep = ";")
library(data.table)
# Baca data sasaran poktan
sasaran_poktan <- fread("data/sasaran_poktan_gabung.csv", sep = ";")
View(sasaran_poktan)
View(sasaran_poktan)
data_pus <- fread("data/data_pus.csv", sep = ";", header = T)
View(data_pus)
## filter bulan hingga
data_pkb <- fread("data/nama pkb.csv", sep = ";")
View(data_pkb)
## batas gu judul
data_bkb_keluarga <- fread("data/data_bkb_keluarga.csv")
View(data_bkb_keluarga)
bumil_hasil <- data.table::fread("I:/Datin/Project/Scraping Profil Desa/hasil/2025-oktober-elsimil-bumil.csv")
bumil_data <- data.table::fread("I:/Datin/Project/profil_sipacoai/data/2025-elsimil-bumil.csv")
library(dplyr)
bumil_data |>
select(KABUPATEN, KECAMATAN, KELURAHAN, `JUMLAH BUMIL`) |>
anti_join(
bumil_hasil |>
select(Kabupaten, Kecamatan, Kelurahan, `Jumlah Bumil`),
by = c("KABUPATEN" = "Kabupaten", "KECAMATAN" = "Kecamatan", "KELURAHAN" = "Kelurahan")
)
shiny::runApp()
# Load data untuk edukasi KBPP
edukasi_kbpp_bumil <- fread("data/2025-elsimil-bumil.csv", sep = ";")
edukasi_kbpp_pascasalin <- fread("data/2025-elsimil-pascasalin.csv", sep = ";")
View(edukasi_kbpp_bumil)
runApp()
runApp()
## poktan
# Load data efficiently at startup
data_bkb <- fread("data/data_bkb.csv", sep = ";")
View(data_bkb)
View(data_bkb)
library(tidyverse)
data_genting <- readxl::read_excel("I:/Rekap Capaian Kelurahan.xlsx")
data_genting <- readxl::read_excel("I:/Rekap Capaian Kelurahan.xlsx")
View(data_genting)
data_genting <- data_genting[-455,]
View(data_genting)
data_desa <- data.table::fread("data/data_daftar_desa.csv")
View(data_desa)
data_desa_Cek <- data_desa |>
left_join(data_genting, by = c("KABUPATEN" = "Kabupaten", "KECAMATAN" = "Kecamatan", "KELURAHAN" = "Desa/KELURAHAN"))
data_desa_Cek <- data_desa |>
left_join(data_genting, by = c("KABUPATEN" = "Kabupaten", "KECAMATAN" = "Kecamatan", "KELURAHAN" = "Desa/Kelurahan"))
data_desa_Cek <- data_desa |>
left_join(data_genting, by = c("KABUPATEN" = "Kabupaten/Kota", "KECAMATAN" = "Kecamatan", "KELURAHAN" = "Desa/Kelurahan"))
View(data_desa_Cek)
data_desa_Cek <- data_desa_Cek |>
replace_na(`Count of Edukasi yang diberikan`, 0)
data_desa_Cek <- data_desa_Cek |>
replace_na(`Count of Edukasi yang diberikan` = 0)
?replace_na
mutate(GENTING = replace_na(`Count of Edukasi yang diberikan`, 0)
)
data_desa_Cek <- data_desa_Cek |>
mutate(GENTING = replace_na(`Count of Edukasi yang diberikan`, 0))
View(data_desa_Cek)
write.csv(data_desa_Cek |>
select(-`Count of Edukasi yang diberikan`),
"data/data_genting.csv")
shiny::runApp()
data_genting <- fread("data/data_genting.csv")
runApp()
data_tamasya <- fread("data/data_tamasya.csv")
runApp()
library(shiny)
library(bslib)
library(collapse)
library(bsicons)
library(data.table)
library(echarts4r)
library(gt)
library(waiter)
library(fst)
runApp()
runApp()
data_ds <- fread("data/data_ds.csv")
runApp()
0/0
runApp()
runApp()
runApp()
data_sidaya <- fread("data/data_sidaya.csv")
View(data_sidaya)
runApp()
# Load library yang diperlukan
library(ggplot2)
library(dplyr)
library(tidyr)
# Buat dataframe dengan data September dan Oktober
data <- data.frame(
Indikator = c(
"Keluarga Mendapat Pendampingan",
"Sasaran Hadir Posyandu",
"Perkembangan Anak",
"Genting",
"Tamasya",
"Edukasi KBPP",
"Lansia (SIDAYA)",
"Remaja (PIK-R)",
"Ayah Teladan (GATI)",
"Peserta KB Aktif"
),
September = c(59.33, 76.79, 33238, 6487, 37, 54.57, 2820, 15025, 11554, 35127),
Oktober = c(57.68, 79.96, 35749, 6487, 37, 68.7, 2829, 15900, 21544, 34581)
)
# Tambahkan kolom perubahan (untuk warna atau label nanti)
data <- data %>%
mutate(
Perubahan = Oktober - September,
Arah = ifelse(Perubahan > 0, "Naik", ifelse(Perubahan < 0, "Turun", "Stabil"))
)
# Plot Slope Graph
ggplot(data, aes(x = "September", y = September, group = Indikator)) +
geom_line(aes(x = "Oktober", y = Oktober),
color = "gray50", size = 0.8) +
geom_point(aes(x = "September", y = September),
color = "steelblue", size = 3) +
geom_point(aes(x = "Oktober", y = Oktober),
color = "orange", size = 3) +
# Tambahkan teks nilai di tiap titik
geom_text(aes(x = "September", y = September, label = round(September, 2)),
hjust = 1.1, vjust = 0.5, size = 3, color = "black") +
geom_text(aes(x = "Oktober", y = Oktober, label = round(Oktober, 2)),
hjust = -0.1, vjust = 0.5, size = 3, color = "black") +
# Atur skala dan tema
scale_y_continuous(labels = function(x) {
ifelse(x >= 1000, format(x, big.mark = ",", scientific = FALSE), x)
}) +
labs(
title = "Perbandingan Indikator Kesehatan Masyarakat Sulawesi Barat\nSeptember vs Oktober",
subtitle = "Slope Graph menunjukkan perubahan nilai antar bulan",
x = "",
y = "Nilai Indikator"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
plot.subtitle = element_text(hjust = 0.5, size = 11, color = "gray50"),
axis.text.x = element_text(size = 12, face = "bold"),
axis.text.y = element_text(size = 10),
panel.grid.major.y = element_line(color = "gray85"),
panel.grid.minor = element_blank(),
legend.position = "none"
) +
coord_flip() # Agar lebih mudah dibaca karena banyak kategori
library(patchwork)
library(ggplot2)
library(dplyr)
library(tidyr)
library(ggrepel)
# Data asli dari gambar
data_raw <- data.frame(
Indikator = c(
"Keluarga Mendapat Pendampingan",
"Sasaran Hadir Posyandu",
"Perkembangan Anak",
"Genting",
"Tamasya",
"Edukasi KBPP",
"Lansia (SIDAYA)",
"Remaja (PIK-R)",
"Ayah Teladan (GATI)",
"Peserta KB Aktif"
),
September = c(59.33, 76.79, 33238, 6487, 37, 54.57, 2820, 15025, 11554, 35127),
Oktober = c(57.68, 79.96, 35749, 6487, 37, 68.7, 2829, 15900, 21544, 34581)
)
# Tambahkan kolom jenis data
data_raw <- data_raw %>%
mutate(
Jenis = case_when(
Indikator %in% c("Keluarga Mendapat Pendampingan", "Sasaran Hadir Posyandu",
"Edukasi KBPP") ~ "Persentase",
TRUE ~ "Absolut"
)
)
# Pisahkan data
data_persen <- data_raw %>% filter(Jenis == "Persentase")
data_absolut <- data_raw %>% filter(Jenis == "Absolut")
# Tambahkan perubahan untuk label
data_persen <- data_persen %>%
mutate(
Perubahan = Oktober - September,
Label_Perubahan = ifelse(Perubahan > 0, paste0("+", round(Perubahan, 2)),
ifelse(Perubahan < 0, round(Perubahan, 2), "0"))
)
data_absolut <- data_absolut %>%
mutate(
Perubahan = Oktober - September,
Label_Perubahan = ifelse(Perubahan > 0, paste0("+", format(Perubahan, big.mark = ",", scientific = FALSE)),
ifelse(Perubahan < 0, format(Perubahan, big.mark = ",", scientific = FALSE), "0"))
)
# Plot untuk Persentase
p_persen <- ggplot(data_persen, aes(x = 1, y = September, group = Indikator)) +
geom_line(aes(x = 2, y = Oktober), color = "gray70", size = 0.8) +
geom_point(aes(x = 1, y = September), color = "steelblue", size = 2.5) +
geom_point(aes(x = 2, y = Oktober), color = "orange", size = 2.5) +
# Tambahkan teks nilai
geom_text(aes(x = 1, y = September, label = paste0(round(September, 2), "%")),
hjust = 1.2, vjust = 0.5, size = 3.5, color = "black", fontface = "bold") +
geom_text(aes(x = 2, y = Oktober, label = paste0(round(Oktober, 2), "%")),
hjust = -0.2, vjust = 0.5, size = 3.5, color = "black", fontface = "bold") +
# Tambahkan label perubahan (opsional)
geom_text_repel(aes(x = 1.5, y = (September + Oktober)/2, label = Label_Perubahan),
color = "darkred", size = 3, segment.color = "gray80", box.padding = 0.3) +
# Atur skala dan tema
scale_x_continuous(breaks = c(1, 2), labels = c("September", "Oktober")) +
labs(
title = "Perbandingan Indikator Persentase\nSulawesi Barat: September vs Oktober",
x = "",
y = ""
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
axis.text.x = element_text(size = 12, face = "bold"),
axis.ticks = element_blank(),
panel.grid.major.y = element_line(color = "gray90"),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.margin = margin(10, 20, 10, 20)
) +
coord_flip() +
scale_y_continuous(expand = expansion(mult = c(0.1, 0.1)))
# Tampilkan plot
print(p_persen)
# Plot untuk Angka Absolut
p_absolut <- ggplot(data_absolut, aes(x = 1, y = September, group = Indikator)) +
geom_line(aes(x = 2, y = Oktober), color = "gray70", size = 0.8) +
geom_point(aes(x = 1, y = September), color = "steelblue", size = 2.5) +
geom_point(aes(x = 2, y = Oktober), color = "orange", size = 2.5) +
# Tambahkan teks nilai
geom_text(aes(x = 1, y = September, label = format(September, big.mark = ",", scientific = FALSE)),
hjust = 1.2, vjust = 0.5, size = 3.5, color = "black", fontface = "bold") +
geom_text(aes(x = 2, y = Oktober, label = format(Oktober, big.mark = ",", scientific = FALSE)),
hjust = -0.2, vjust = 0.5, size = 3.5, color = "black", fontface = "bold") +
# Tambahkan label perubahan
geom_text_repel(aes(x = 1.5, y = (September + Oktober)/2, label = Label_Perubahan),
color = "darkred", size = 3, segment.color = "gray80", box.padding = 0.3) +
# Atur skala dan tema
scale_x_continuous(breaks = c(1, 2), labels = c("September", "Oktober")) +
labs(
title = "Perbandingan Indikator Angka Absolut\nSulawesi Barat: September vs Oktober",
x = "",
y = ""
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
axis.text.x = element_text(size = 12, face = "bold"),
axis.ticks = element_blank(),
panel.grid.major.y = element_line(color = "gray90"),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.margin = margin(10, 20, 10, 20)
) +
coord_flip() +
scale_y_continuous(expand = expansion(mult = c(0.1, 0.1)))
# Tampilkan plot
print(p_absolut)
library(patchwork)
p_persen + p_absolut + plot_layout(ncol = 1, heights = c(1, 1))
library(tidyverse)
# Buat data frame Anda (contoh sebagian data dari gambar)
data_gdp <- data.frame(
Country = c("Sweden", "Netherlands", "Norway", "Britain", "France", "Germany", "Finland", "Canada", "Belgium", "Italy", "US", "Greece", "Switzerland", "Spain", "Japan",
"Sweden", "Netherlands", "Norway", "Britain", "France", "Germany", "Finland", "Canada", "Belgium", "Italy", "US", "Greece", "Switzerland", "Spain", "Japan"),
Year = c(rep(1970, 15), rep(1979, 15)),
GDP = c(47, 44, 44, 41, 39, 39, 35, 35, 35, 30, 30, 27, 26, 22, 21,
57, 56, 52, 38, 43, 43, 39, 36, 43, 36, 31, 27, 32, 27, 27)
)
# Jika data Anda masih dalam format lebar (Year1970, Year1979), gunakan pivot_longer():
# data_long <- data_wide %>%
#   pivot_longer(cols = starts_with("Year"),
#                names_to = "Year",
#                names_prefix = "Year",
#                values_to = "GDP")
# data_long$Year <- as.factor(data_long$Year) # Pastikan Year adalah faktor
# Tentukan negara yang ingin di highlight (seperti garis merah di gambar)
highlight_countries <- c("Belgium", "France", "Germany", "Finland", "Canada", "Italy")
# Tentukan warna untuk highlight dan non-highlight
line_color <- ifelse(data_gdp$Country %in% highlight_countries, "red", "gray")
p <- ggplot(data_gdp, aes(x = Year, y = GDP, group = Country, color = Country %in% highlight_countries)) +
# Garis penghubung
geom_line(aes(color = Country %in% highlight_countries), size = 1, alpha = 0.8) +
# Titik data
geom_point(aes(color = Country %in% highlight_countries), size = 2) +
# Penyesuaian skala X untuk tampilan 1970 dan 1979
scale_x_continuous(breaks = c(1970, 1979),
labels = c("Year\n1970", "Year\n1979")) +
# Skema warna - atur secara manual untuk abu-abu dan merah
scale_color_manual(values = c("TRUE" = "red", "FALSE" = "gray")) +
# Hilangkan legenda warna
guides(color = "none") +
# Judul dan label sumbu
labs(title = "Gross GDP",
x = NULL,
y = NULL) +
# Tema minimal
theme_minimal() +
# Penyesuaian tema untuk tampilan Tufte-style
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.y = element_blank(),      # Hilangkan label Y sumbu (karena kita akan pakai label teks)
axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
)
# Menambahkan label pada titik (Negara dan GDP)
# Pisahkan data untuk label kiri dan kanan
data_1970 <- filter(data_gdp, Year == 1970)
data_1979 <- filter(data_gdp, Year == 1979)
p +
# Label Kiri (Negara)
geom_text(data = data_1970,
aes(label = Country, x = 1969.8, color = Country %in% highlight_countries),
hjust = 1, size = 3.5, fontface = "bold") +
# Label Kiri (Nilai GDP)
geom_text(data = data_1970,
aes(label = GDP, x = 1970.2, color = Country %in% highlight_countries),
hjust = 0, size = 3.5) +
# Label Kanan (Negara)
geom_text(data = data_1979,
aes(label = Country, x = 1979.2, color = Country %in% highlight_countries),
hjust = 0, size = 3.5, fontface = "bold") +
# Label Kanan (Nilai GDP)
geom_text(data = data_1979,
aes(label = GDP, x = 1978.8, color = Country %in% highlight_countries),
hjust = 1, size = 3.5) +
# Atur batas sumbu X secara manual untuk memberi ruang pada label
coord_cartesian(xlim = c(1969.5, 1979.5))
library(tidyverse)
# Buat data frame Anda (contoh sebagian data dari gambar)
data_gdp <- data.frame(
Country = c("Sweden", "Netherlands", "Norway", "Britain", "France", "Germany", "Finland", "Canada", "Belgium", "Italy", "US", "Greece", "Switzerland", "Spain", "Japan",
"Sweden", "Netherlands", "Norway", "Britain", "France", "Germany", "Finland", "Canada", "Belgium", "Italy", "US", "Greece", "Switzerland", "Spain", "Japan"),
Year = c(rep(1970, 15), rep(1979, 15)),
GDP = c(47, 44, 44, 41, 39, 39, 35, 35, 35, 30, 30, 27, 26, 22, 21,
57, 56, 52, 38, 43, 43, 39, 36, 43, 36, 31, 27, 32, 27, 27)
)
# Jika data Anda masih dalam format lebar (Year1970, Year1979), gunakan pivot_longer():
# data_long <- data_wide %>%
#   pivot_longer(cols = starts_with("Year"),
#                names_to = "Year",
#                names_prefix = "Year",
#                values_to = "GDP")
# data_long$Year <- as.factor(data_long$Year) # Pastikan Year adalah faktor\
# Tentukan negara yang ingin di highlight (seperti garis merah di gambar)
highlight_countries <- c("Belgium", "France", "Germany", "Finland", "Canada", "Italy")
# Tentukan warna untuk highlight dan non-highlight
line_color <- ifelse(data_gdp$Country %in% highlight_countries, "red", "gray")
p <- ggplot(data_gdp, aes(x = Year, y = GDP, group = Country, color = Country %in% highlight_countries)) +
# Garis penghubung
geom_line(aes(color = Country %in% highlight_countries), size = 1, alpha = 0.8) +
# Titik data
geom_point(aes(color = Country %in% highlight_countries), size = 2) +
# Penyesuaian skala X untuk tampilan 1970 dan 1979
scale_x_continuous(breaks = c(1970, 1979),
labels = c("Year\n1970", "Year\n1979")) +
# Skema warna - atur secara manual untuk abu-abu dan merah
scale_color_manual(values = c("TRUE" = "red", "FALSE" = "gray")) +
# Hilangkan legenda warna
guides(color = "none") +
# Judul dan label sumbu
labs(title = "Gross GDP",
x = NULL,
y = NULL) +
# Tema minimal
theme_minimal() +
# Penyesuaian tema untuk tampilan Tufte-style
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.y = element_blank(),      # Hilangkan label Y sumbu (karena kita akan pakai label teks)
axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
)
# Menambahkan label pada titik (Negara dan GDP)
# Pisahkan data untuk label kiri dan kanan
data_1970 <- filter(data_gdp, Year == 1970)
data_1979 <- filter(data_gdp, Year == 1979)
p +
# Label Kiri (Negara)
geom_text(data = data_1970,
aes(label = Country, x = 1969.8, color = Country %in% highlight_countries),
hjust = 1, size = 3.5, fontface = "bold") +
# Label Kiri (Nilai GDP)
geom_text(data = data_1970,
aes(label = GDP, x = 1970.2, color = Country %in% highlight_countries),
hjust = 0, size = 3.5) +
# Label Kanan (Negara)
geom_text(data = data_1979,
aes(label = Country, x = 1979.2, color = Country %in% highlight_countries),
hjust = 0, size = 3.5, fontface = "bold") +
# Label Kanan (Nilai GDP)
geom_text(data = data_1979,
aes(label = GDP, x = 1978.8, color = Country %in% highlight_countries),
hjust = 1, size = 3.5) +
# Atur batas sumbu X secara manual untuk memberi ruang pada label
coord_cartesian(xlim = c(1969.5, 1979.5))
library(tidyverse)
# Buat data frame Anda (contoh sebagian data dari gambar)
data_gdp <- data.frame(
Country = c("Sweden", "Netherlands", "Norway", "Britain", "France", "Germany", "Finland", "Canada", "Belgium", "Italy", "US", "Greece", "Switzerland", "Spain", "Japan",
"Sweden", "Netherlands", "Norway", "Britain", "France", "Germany", "Finland", "Canada", "Belgium", "Italy", "US", "Greece", "Switzerland", "Spain", "Japan"),
Year = c(rep(1970, 15), rep(1979, 15)),
GDP = c(47, 44, 44, 41, 39, 39, 35, 35, 35, 30, 30, 27, 26, 22, 21,
57, 56, 52, 38, 43, 43, 39, 36, 43, 36, 31, 27, 32, 27, 27)
)
# Jika data Anda masih dalam format lebar (Year1970, Year1979), gunakan pivot_longer():
# data_long <- data_wide %>%
#   pivot_longer(cols = starts_with("Year"),
#                names_to = "Year",
#                names_prefix = "Year",
#                values_to = "GDP")
# data_long$Year <- as.factor(data_long$Year) # Pastikan Year adalah faktor\
# Tentukan negara yang ingin di highlight (seperti garis merah di gambar)
highlight_countries <- c("Belgium", "France", "Germany", "Finland", "Canada", "Italy")
# Tentukan warna untuk highlight dan non-highlight
line_color <- ifelse(data_gdp$Country %in% highlight_countries, "red", "gray")
p <- ggplot(data_gdp, aes(x = Year, y = GDP, group = Country, color = Country %in% highlight_countries)) +
# Garis penghubung
geom_line(aes(color = Country %in% highlight_countries), size = 1, alpha = 0.8) +
# Titik data
geom_point(aes(color = Country %in% highlight_countries), size = 2) +
# Penyesuaian skala X untuk tampilan 1970 dan 1979
scale_x_continuous(breaks = c(1970, 1979),
labels = c("Year\n1970", "Year\n1979")) +
# Skema warna - atur secara manual untuk abu-abu dan merah
scale_color_manual(values = c("TRUE" = "red", "FALSE" = "gray")) +
# Hilangkan legenda warna
guides(color = "none") +
# Judul dan label sumbu
labs(title = "Gross GDP",
x = NULL,
y = NULL) +
# Tema minimal
theme_minimal() +
# Penyesuaian tema untuk tampilan Tufte-style
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.y = element_blank(),      # Hilangkan label Y sumbu (karena kita akan pakai label teks)
axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
)
# Menambahkan label pada titik (Negara dan GDP)
# Pisahkan data untuk label kiri dan kanan
data_1970 <- filter(data_gdp, Year == 1970)
data_1979 <- filter(data_gdp, Year == 1979)
p +
# Label Kiri (Negara)
geom_text(data = data_1970,
aes(label = Country, x = 1969.8, color = Country %in% highlight_countries),
hjust = 1, size = 3.5, fontface = "bold") +
# Label Kiri (Nilai GDP)
geom_text(data = data_1970,
aes(label = GDP, x = 1970.2, color = Country %in% highlight_countries),
hjust = 0, size = 3.5) +
# Label Kanan (Negara)
geom_text(data = data_1979,
aes(label = Country, x = 1979.2, color = Country %in% highlight_countries),
hjust = 0, size = 3.5, fontface = "bold") +
# Label Kanan (Nilai GDP)
geom_text(data = data_1979,
aes(label = GDP, x = 1978.8, color = Country %in% highlight_countries),
hjust = 1, size = 3.5) +
# Atur batas sumbu X secara manual untuk memberi ruang pada label
coord_cartesian(xlim = c(1969.5, 1979.5))
