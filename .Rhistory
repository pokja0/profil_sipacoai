x = "Bulan",
y = "Jumlah KBPP"
) +
# theme_minimal() +
theme(
axis.text.x = element_text(angle = 0, hjust = 1, size = 8),   # ukuran teks sumbu X
axis.text.y = element_text(size = 8),
axis.title = element_text(size = 10),
legend.text = element_text(size = 8),
legend.title = element_text(size = 10),
strip.text = element_text(face = "bold", size = 10),           # judul panel
plot.title = element_text(hjust = 0.5, size = 16),             # judul utama
plot.subtitle = element_text(hjust = 0.5, size = 12),
panel.grid.minor = element_blank(),
text = element_text(family = "sans")
)
# Simpan sebagai file HD
ggsave(
filename = "mateng_plot_per_kecamatan_HD.png",
plot = p,
width = 1920*2,   # dalam piksel (Full HD lebar)
height = 1080*2,  # dalam piksel (Full HD tinggi)
unit = "px",
dpi = 150*2,      # resolusi tinggi (bisa naikkan ke 300 untuk cetak)
bg = "white"
)
data_kbpp <- read_xlsx("I:/Tabel4.xlsx", 12)
data_long <- data_kbpp %>%
pivot_longer(cols = -KECAMATAN, names_to = "Bulan", values_to = "Jumlah") %>%
mutate(
Bulan = case_match(Bulan,
"JANUARI" ~ "JAN",
"FEBRUARI" ~ "FEB",
"MARET" ~ "MAR",
"APRIL" ~ "APR",
"MEI" ~ "MEI",
"JUNI" ~ "JUN",
"JULI" ~ "JUL"),
Bulan = factor(Bulan, levels = c("JAN", "FEB", "MAR", "APR", "MEI", "JUN", "JUL"))
)
# Buat plot: satu grafik per kecamatan
p <- ggplot(data_long, aes(x = Bulan, y = Jumlah)) +
geom_line(color = "blue", size = 1, group = 1) +  # satu garis per kecamatan
geom_point(color = "blue", size = 2) +
geom_text(aes(label = Jumlah), vjust = -0.8, size = 3.5, color = "black") +
scale_y_continuous(
limits = c(0, max(data_long$Jumlah) + 15),
expand = c(0, 0)
) +
facet_wrap(~ KECAMATAN, ncol = 3, scales = "free_x") +  # tiap kecamatan punya grafik sendiri
labs(
title = "Capaian KBPP Per Kecamatan di Kabupaten Mamuju Tengah",
subtitle = "Sumber: SIGA",
x = "Bulan",
y = "Jumlah KBPP"
) +
# theme_minimal() +
theme(
axis.text.x = element_text(angle = 0, hjust = 1, size = 8),   # ukuran teks sumbu X
axis.text.y = element_text(size = 8),
axis.title = element_text(size = 10),
legend.text = element_text(size = 8),
legend.title = element_text(size = 10),
strip.text = element_text(face = "bold", size = 10),           # judul panel
plot.title = element_text(hjust = 0.5, size = 16),             # judul utama
plot.subtitle = element_text(hjust = 0.5, size = 12),
panel.grid.minor = element_blank(),
text = element_text(family = "sans")
)
p
# Buat plot: satu grafik per kecamatan
p <- ggplot(data_long, aes(x = Bulan, y = Jumlah)) +
geom_line(color = "blue", size = 1, group = 1) +  # satu garis per kecamatan
geom_point(color = "blue", size = 2) +
geom_text(aes(label = Jumlah), vjust = -0.8, size = 3.5, color = "black") +
scale_y_continuous(
limits = c(0, max(data_long$Jumlah) + 15),
expand = c(0, 0)
) +
facet_wrap(~ KECAMATAN, ncol = 4, scales = "free_x") +  # tiap kecamatan punya grafik sendiri
labs(
title = "Capaian KBPP Per Kecamatan di Kabupaten Mamuju",
subtitle = "Sumber: SIGA",
x = "Bulan",
y = "Jumlah KBPP"
) +
# theme_minimal() +
theme(
axis.text.x = element_text(angle = 0, hjust = 1, size = 8),   # ukuran teks sumbu X
axis.text.y = element_text(size = 8),
axis.title = element_text(size = 10),
legend.text = element_text(size = 8),
legend.title = element_text(size = 10),
strip.text = element_text(face = "bold", size = 10),           # judul panel
plot.title = element_text(hjust = 0.5, size = 16),             # judul utama
plot.subtitle = element_text(hjust = 0.5, size = 12),
panel.grid.minor = element_blank(),
text = element_text(family = "sans")
)
# Simpan sebagai file HD
ggsave(
filename = "mamuju_plot_per_kecamatan_HD.png",
plot = p,
width = 1920*2,   # dalam piksel (Full HD lebar)
height = 1080*2,  # dalam piksel (Full HD tinggi)
unit = "px",
dpi = 150*2,      # resolusi tinggi (bisa naikkan ke 300 untuk cetak)
bg = "white"
)
p
library(tidyverse)
library(gsheet)
data_pelayanan <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1Yv6FaSPkaZ1BeR2R5qRBNsp4mqJknuu_koBrZ3BLsn0/edit?gid=0#gid=0")
View(data_pelayanan)
aggregat <- data_pelayanan |>
group_by(`Jenis layanan yang sedang atau pernah diterima`) |>
summarise(total = n())
View(aggregat)
### 1. Buat Contoh Dataframe
# Dataframe ini meniru struktur yang Anda berikan.
df_sebelum <- data.frame(
layanan = c(
"Layanan BKR, BKB, BKL, atau UPPKA, Layanan Pemberian KIE Program BANGGA KENCANA",
"Layanan BKR, BKB, BKL, atau UPPKA, Layanan Bimbingan Teknis Tenaga Lini Lapangan",
"Layanan KB Metode Kontrasepsi Jangka Panjang (MKJP)"
)
)
print("Dataframe Sebelum Transformasi:")
print(df_sebelum)
### 2. Lakukan Transformasi
# Gunakan 'separate_rows()' untuk memisahkan baris berdasarkan koma.
# Kemudian, gunakan 'mutate()' dan 'str_trim()' untuk membersihkan spasi di setiap baris.
df_sesudah <- df_sebelum %>%
separate_rows(layanan, sep = ",") %>%
mutate(layanan = str_trim(layanan))
df_sebelum %>%
separate_rows(layanan, sep = ",")
View(df_sebelum)
group_by(`Jenis layanan yang sedang atau pernah diterima`) |>
summarise(total = n())
aggregat <- data_pelayanan |>
separate_rows(`Jenis layanan yang sedang atau pernah diterima`, sep = ",") |>
mutate(`Jenis layanan yang sedang atau pernah diterima` = str_trim(`Jenis layanan yang sedang atau pernah diterima`)) |>
group_by(`Jenis layanan yang sedang atau pernah diterima`) |>
summarise(total = n())
View(aggregat)
View(data_pelayanan)
aggregat <- data_pelayanan |>
mutate(
layanan_pertama = str_extract(`Jenis layanan yang sedang atau pernah diterima`, "^[^,]+") %>% str_trim()
)
View(aggregat)
aggregat <- data_pelayanan |>
mutate(
layanan_pertama = str_extract(`Jenis layanan yang sedang atau pernah diterima`, "^[^,]+") %>% str_trim()
) |>
select(`Jenis layanan yang sedang atau pernah diterima`, layanan_pertama)
View(aggregat)
View(aggregat)
aggregat <- data_pelayanan |>
mutate(
layanan_pertama = str_extract(`Jenis layanan yang sedang atau pernah diterima`, "^[^,]+") %>% str_trim()
) |>
select(`Jenis layanan yang sedang atau pernah diterima`, layanan_pertama) |>
group_by(layanan_pertama) |>
summarise(total = n())
View(aggregat)
sum(aggregat$total)
library(tidyverse)
library(gsheet)
data_pelayanan <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1Yv6FaSPkaZ1BeR2R5qRBNsp4mqJknuu_koBrZ3BLsn0/edit?gid=1557650070#gid=1557650070")
aggregat <- data_pelayanan |>
mutate(
layanan_pertama = str_extract(`Jenis layanan yang sedang atau pernah diterima`, "^[^,]+") %>% str_trim()
) |>
select(`Jenis layanan yang sedang atau pernah diterima`, layanan_pertama) |>
group_by(layanan_pertama) |>
summarise(total = n())
View(aggregat)
### 1. Buat Contoh Dataframe
# Dataframe ini meniru struktur yang Anda berikan.
df_sebelum <- data.frame(
layanan = c(
"Layanan BKR, BKB, BKL, atau UPPKA, Layanan Pemberian KIE Program BANGGA KENCANA",
"Layanan BKR, BKB, BKL, atau UPPKA, Layanan Bimbingan Teknis Tenaga Lini Lapangan",
"Layanan KB Metode Kontrasepsi Jangka Panjang (MKJP)"
)
)
print("Dataframe Sebelum Transformasi:")
print(df_sebelum)
### 2. Lakukan Transformasi
# Gunakan 'separate_rows()' untuk memisahkan baris berdasarkan koma.
# Kemudian, gunakan 'mutate()' dan 'str_trim()' untuk membersihkan spasi di setiap baris.
df_sesudah <- df_sebelum %>%
separate_rows(layanan, sep = ",") %>%
mutate(layanan = str_trim(layanan))
### 3. Tampilkan Hasil
print("Dataframe Setelah Transformasi:")
print(df_sesudah)
View(aggregat)
View(data_pelayanan)
sum(aggregat$total)
View(data_pelayanan)
View(aggregat)
data_pelayanan <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1Yv6FaSPkaZ1BeR2R5qRBNsp4mqJknuu_koBrZ3BLsn0/edit?gid=1557650070#gid=1557650070")
aggregat <- data_pelayanan |>
mutate(
layanan_pertama = str_extract(`Jenis layanan yang sedang atau pernah diterima`, "^[^,]+") %>% str_trim()
) |>
select(`Jenis layanan yang sedang atau pernah diterima`, layanan_pertama) |>
group_by(layanan_pertama) |>
summarise(total = n())
### 1. Buat Contoh Dataframe
# Dataframe ini meniru struktur yang Anda berikan.
df_sebelum <- data.frame(
layanan = c(
"Layanan BKR, BKB, BKL, atau UPPKA, Layanan Pemberian KIE Program BANGGA KENCANA",
"Layanan BKR, BKB, BKL, atau UPPKA, Layanan Bimbingan Teknis Tenaga Lini Lapangan",
"Layanan KB Metode Kontrasepsi Jangka Panjang (MKJP)"
)
)
print("Dataframe Sebelum Transformasi:")
View(data_pelayanan)
View(aggregat)
View(data_pelayanan)
library(gsheet)
?gsheet2tbl
data_gati_pusat <- read.csv(text = gsheet2text("https://docs.google.com/spreadsheets/d/1q9b1qY3apYzFhMPF0UrLPG81D--ugOYEVMjWbRxW7Q8/edit?gid=0#gid=0",
format = 'csv'))
View(data_gati_pusat)
kompak_tenan <- read.csv(text = gsheet2text("https://docs.google.com/spreadsheets/d/1FloG5HND1FVPt7j5HwqdqqFDQDotJ61lE5Dok73yhOo/edit?gid=783430531#gid=783430531",
format = 'csv'), skip = 3)
View(kompak_tenan)
sebaya <- read.csv(text = gsheet2text("https://docs.google.com/spreadsheets/d/1FloG5HND1FVPt7j5HwqdqqFDQDotJ61lE5Dok73yhOo/edit?gid=1829057052#gid=1829057052",
format = 'csv'), skip = 2)
dekat <- read.csv(text = gsheet2text("https://docs.google.com/spreadsheets/d/1FloG5HND1FVPt7j5HwqdqqFDQDotJ61lE5Dok73yhOo/edit?gid=43711692#gid=43711692",
format = 'csv'), skip = 3)
View(sebaya)
View(data_gati_pusat)
View(dekat)
View(data_gati_pusat)
View(kompak_tenan)
library(tidyverse)
data_gati_pusat <- data_gati_pusat |>
mutate(Kabupaten = toupper(a),
Kecamatan = toupper(Kecamatan),
Desa.Kelurahan = toupper(Desa.Kelurahan),
Nama = toupper(MUHAMMAD.YUSUF.S.M))
View(kompak_tenan)
View(kompak_tenan)
selisih <- anti_join(kompak_tenan, data_gati_pusat, by = c("Kabupaten", "Kecamatan", "Desa.Kelurahan"))
kompak_tenan <- kompak_tenan |>
mutate(Kabupaten = toupper(LOKASI.KEGIATAN..Pilih.opsi.berikut..),
Kecamatan = toupper(KECAMATAN),
Desa.Kelurahan = toupper(DESA.KELURAHAN))
selisih <- anti_join(kompak_tenan, data_gati_pusat, by = c("Kabupaten", "Kecamatan", "Desa.Kelurahan"))
View(selisih)
shiny::runApp('I:/Datin/Project/profil_sipacoai')
filter_kabupaten = c("PASANGKAYU", "PASANGKAYU", "MAMUJU", "MAMUJU")
filter_kecamatan = c("PASANGKAYU", "PASANGKAYU", "PAPALANG", "PAPALANG")
filter_desa = c("AKO", "GUNUNG SARI", "BODA-BODA", "SISANGO")
filter_bulan = c('SEPTEMBER')
filter_data <- reactive({
list(
# Trigger reactivity with action button
kabupaten <- filter_kabupaten,
kecamatan <- filter_kecamatan  ,
desa <- filter_desa,
bulan <- filter_bulan
)
})
filter_data <-
list(
# Trigger reactivity with action button
kabupaten <- filter_kabupaten,
kecamatan <- filter_kecamatan  ,
desa <- filter_desa,
bulan <- filter_bulan
)
View(filter_data)
# Base filtering function
apply_filter <- function(data, include_bulan = TRUE) {
filters <- filter_data()
result <- data |>
fsubset(KABUPATEN %in% filters$kabupaten &
KECAMATAN %in% filters$kecamatan &
KELURAHAN %in% filters$desa)
if(include_bulan) {
result <- result |> fsubset(BULAN == filters$bulan)
}
result
}
## poktan
# Load data efficiently at startup
data_bkb <- fread("data/data_bkb.csv", sep = ";")
setwd("I:/Datin/Project/profil_sipacoai")
# Cached reactive for jumlah desa (used by multiple value boxes)
jumlah_desa_val <-
apply_filter(data_bkb) |> fnrow()
filters <- filter_data
# Base filtering function
apply_filter <- function(data, include_bulan = TRUE) {
filters <- filter_data
result <- data |>
fsubset(KABUPATEN %in% filters$kabupaten &
KECAMATAN %in% filters$kecamatan &
KELURAHAN %in% filters$desa)
if(include_bulan) {
result <- result |> fsubset(BULAN == filters$bulan)
}
result
}
# Cached reactive for jumlah desa (used by multiple value boxes)
jumlah_desa_val <-
apply_filter(data_bkb) |> fnrow()
## poktan
# Load data efficiently at startup
data_bkb <- fread("data/data_bkb.csv", sep = ";")
# Cached reactive for jumlah desa (used by multiple value boxes)
jumlah_desa_val <-
apply_filter(data_bkb) |> fnrow()
filters <- filter_data
result <- data_bkb |>
fsubset(KABUPATEN %in% filters$kabupaten &
KECAMATAN %in% filters$kecamatan &
KELURAHAN %in% filters$desa)
View(data_bkb)
filters$kabupaten
filters
result <- data_bkb |>
fsubset(KABUPATEN %in% filters[1] &
KECAMATAN %in% filters$kecamatan &
KELURAHAN %in% filters$desa)
filters$kabupaten
filters[1]
result <- data_bkb |>
fsubset(KABUPATEN %in% filters[1] &
KECAMATAN %in% filters[2] &
KELURAHAN %in% filters[3])
filters[1]
result <- data_bkb |>
fsubset(KABUPATEN %in% filters[1] &
KECAMATAN %in% filters[2] &
KELURAHAN %in% filters[3])
data_bkb
result <- data_bkb |>
fsubset(KABUPATEN %in% filters[1])
filters[1]
result <- data_bkb |>
fsubset(KABUPATEN %in% c(filters[1]))
c(filters[1])
Filters
filters_data <- filter_data
filters_data
filters_data[[1]]
result <- data_bkb |>
fsubset(KABUPATEN %in% filters_data[[1]] &
KECAMATAN %in% filters[[2]] &
KELURAHAN %in% filters[[3]])
runApp()
filters[[4]]
runApp()
runApp()
shiny::runApp()
library(gt)
runApp()
runApp()
rlang::sym()
runApp()
runApp()
runApp()
collapse::j
Sys.time()
runApp()
## stunting
data_krs_verval = fread("data/data_verval_krs_2024_sem2.csv", sep=";")
runApp()
runApp()
filter_kabupaten = c("PASANGKAYU", "PASANGKAYU", "MAMUJU", "MAMUJU")
filter_kecamatan = c("PASANGKAYU", "PASANGKAYU", "PAPALANG", "PAPALANG")
filter_desa = c("AKO", "GUNUNG SARI", "BODA-BODA", "SISANGO")
filter_bulan = c('SEPTEMBER')
## batas gu judul
data_bkb_keluarga <- fread("data/data_bkb_keluarga.csv")
# --- Agregasi BKB ---
# Filter and aggregate BKB data
bkb_filtered <- fsubset(data_bkb_keluarga,
KABUPATEN %in% filter_kabupaten &
KECAMATAN %in% filter_kecamatan &
KELURAHAN %in% filter_desa &
BULAN %in% filter_bulan)
bkb_hadir <- fgroup_by(bkb_filtered, PROVINSI) %>%
fsummarise(Keluarga_Hadir_BKB = fsum(`JUMLAH KELUARGA ANGGOTA BKB HADIR PERTEMUAN`, na.rm = TRUE))
View(bkb_hadir)
runApp()
# For demonstration, creating dummy BKR data
bkr_hadir <- data.frame(
PROVINSI = unique(bkb_hadir$PROVINSI),
Keluarga_Hadir_BKR = 0
)
## poktan
# Load data efficiently at startup
data_bkb <- fread("data/data_bkb.csv", sep = ";")
data_bkr <- fread("data/data_bkr.csv", sep = ";")
data_bkl <- fread("data/data_bkl.csv", sep = ";")
data_uppka <- fread("data/data_uppka.csv", sep = ";")
data_pikr <- fread("data/data_pikr.csv", sep = ";")
data_kkb <- fread("data/data_kkb.csv", sep = ";")
data_rdk <- fread("data/data_rdk.csv", sep = ";")
# For demonstration, creating dummy BKR data
bkr_hadir <- data.frame(
PROVINSI = unique(bkb_hadir$PROVINSI),
Keluarga_Hadir_BKR = 0
)
View(bkr_hadir)
# For demonstration, creating dummy BKL data
bkl_hadir <- data.frame(
PROVINSI = unique(bkb_hadir$PROVINSI),
Keluarga_Hadir_BKL = 0
)
# For demonstration, creating dummy PUS data
pus_total <- data.frame(
PROVINSI = unique(bkb_hadir$PROVINSI),
Jumlah_PUS = 100 # dummy value
)
# Gabungkan semua data
df_gabungan <- merge(bkb_hadir, bkr_hadir, by = "PROVINSI", all = TRUE)
df_gabungan <- merge(df_gabungan, bkl_hadir, by = "PROVINSI", all = TRUE)
df_gabungan <- merge(df_gabungan, pus_total, by = "PROVINSI", all = TRUE)
# Isi nilai NA dengan 0
df_gabungan[is.na(df_gabungan)] <- 0
# Terapkan rumus: ((BKB + BKR + BKL) / 3) / PUS
df_gabungan$Pembilang <- (df_gabungan$Keluarga_Hadir_BKB +
df_gabungan$Keluarga_Hadir_BKR +
df_gabungan$Keluarga_Hadir_BKL) / 3
# Pembagian akhir dengan penanganan pembagian dengan nol
df_gabungan$Jumlah_Hasil_Akhir <- ifelse(df_gabungan$Jumlah_PUS > 0,
df_gabungan$Pembilang / df_gabungan$Jumlah_PUS,
0)
# Ambil hasil akhir
hasil_akhir <- df_gabungan$Jumlah_Hasil_Akhir[1]
# Format hasil sebagai persentase
hasil_persen <- round(hasil_akhir * 100, 2)
hasil_formatted <- gsub("\\.", ",", format(hasil_persen, nsmall = 2))
return(paste0(hasil_formatted, "%"))
runApp()
# --- Agregasi BKB ---
# Filter and aggregate BKB data
bkb_filtered <- fsubset(data_bkb_keluarga,
KABUPATEN %in% filter_kabupaten &
KECAMATAN %in% filter_kecamatan &
KELURAHAN %in% filter_desa &
BULAN %in% filter_bulan)
bkb_hadir <- fgroup_by(bkb_filtered, PROVINSI) %>%
fsummarise(Keluarga_Hadir_BKB = fsum(`JUMLAH KELUARGA ANGGOTA BKB HADIR PERTEMUAN`, na.rm = TRUE))
# --- Agregasi BKR ---
# Note: Assuming data_bkr exists - you'll need to load it
bkr_filtered <- fsubset(data_bkr,
KABUPATEN %in% filter_kabupaten &
KECAMATAN %in% filter_kecamatan &
KELURAHAN %in% filter_desa &
BULAN %in% filter_bulan)
bkr_hadir <- fgroup_by(bkr_filtered, PROVINSI) %>%
fsummarise(Keluarga_Hadir_BKR = fsum(`JUMLAH KELUARGA ANGGOTA BKR HADIR PERTEMUAN`, na.rm = TRUE))
# --- Agregasi BKL ---
# Note: Assuming data_bkl exists - you'll need to load it
bkl_filtered <- fsubset(data_bkl,
KABUPATEN %in% filter_kabupaten &
KECAMATAN %in% filter_kecamatan &
KELURAHAN %in% filter_desa &
BULAN %in% filter_bulan)
bkl_hadir <- fgroup_by(bkl_filtered, PROVINSI) %>%
fsummarise(Keluarga_Hadir_BKL = fsum(`JUMLAH ANGGOTA KELUARGA HADIR`, na.rm = TRUE))
# For demonstration, creating dummy PUS data
pus_total <- data.frame(
PROVINSI = unique(bkb_hadir$PROVINSI),
Jumlah_PUS = 100 # dummy value
)
runApp()
result <- data_pikr |>
fsubset(
KABUPATEN %in% filter_kabupaten &
KECAMATAN %in% filter_kecamatan &
KELURAHAN %in% filter_desa &
BULAN %in% filter_bulan
) |>
fgroup_by(PROVINSI) |>
fsummarise(JUMLAH_REMAJA = fsum(`JUMLAH REMAJA HADIR DALAM PERTEMUAN`, na.rm = TRUE)) |>
fselect(JUMLAH_REMAJA) |>
unlist() |>
as.numeric()
paste0(result, "%")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
